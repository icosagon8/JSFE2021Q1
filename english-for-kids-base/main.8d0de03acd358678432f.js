(()=>{"use strict";var e={353:(e,t,n)=>{e.exports=n.p+"assets/4c5818f5735ba26f71be.svg"},790:(e,t,n)=>{e.exports=n.p+"assets/ad178c0df28bc133be34.svg"}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{class e{constructor(e=null,t="div",n=[],i="",s=[]){this.element=document.createElement(t),n.length&&this.element.classList.add(...n),e&&e.append(this.element),this.element.textContent=i,s.length&&this.setAttributes(s)}setAttributes(e){e.forEach((e=>{const[t,n]=e;this.element.setAttribute(t,n)}))}}var t=n(353),i=n(790);class s extends e{constructor(n){super(n,"footer",["container","footer"]),this.wrapper=new e(this.element,"div",["footer__wrapper"]),this.githubLink=new e(this.wrapper.element,"a",["footer__github-link"],"",[["href","https://github.com/icosagon8/"],["target","blank"]]),this.githubLogo=new e(this.githubLink.element,"img",["footer__github-logo"],"",[["src",`${t}`],["width","32"],["height","32"],["alt","Github - icosagon8"]]),this.year=new e(this.wrapper.element,"time",["footer__year"],"2021",[["datetime","2021"]]),this.courseLink=new e(this.wrapper.element,"a",["footer__course-link"],"",[["href","https://rs.school/js/"],["target","blank"]]),this.courseLogo=new e(this.courseLink.element,"img",["footer__course-logo"],"",[["src",`${i}`],["width","100"],["height","37"],["alt","RS School"]])}}function a(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var r="function"==typeof Symbol&&Symbol.observable||"@@observable",o=function(){return Math.random().toString(36).substring(7).split("").join(".")},l={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function d(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}const c="UPDATE_PAGE",h={category:"Main Page"},m="CHANGE_PLAY_MODE",u={isPlayMode:!1},p=function e(t,n,i){var s;if("function"==typeof n&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error(a(0));if("function"==typeof n&&void 0===i&&(i=n,n=void 0),void 0!==i){if("function"!=typeof i)throw new Error(a(1));return i(e)(t,n)}if("function"!=typeof t)throw new Error(a(2));var o=t,c=n,h=[],m=h,u=!1;function p(){m===h&&(m=h.slice())}function g(){if(u)throw new Error(a(3));return c}function w(e){if("function"!=typeof e)throw new Error(a(4));if(u)throw new Error(a(5));var t=!0;return p(),m.push(e),function(){if(t){if(u)throw new Error(a(6));t=!1,p();var n=m.indexOf(e);m.splice(n,1),h=null}}}function f(e){if(!d(e))throw new Error(a(7));if(void 0===e.type)throw new Error(a(8));if(u)throw new Error(a(9));try{u=!0,c=o(c,e)}finally{u=!1}for(var t=h=m,n=0;n<t.length;n++)(0,t[n])();return e}function _(e){if("function"!=typeof e)throw new Error(a(10));o=e,f({type:l.REPLACE})}function v(){var e,t=w;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(a(11));function n(){e.next&&e.next(g())}return n(),{unsubscribe:t(n)}}})[r]=function(){return this},e}return f({type:l.INIT}),(s={dispatch:f,subscribe:w,getState:g,replaceReducer:_})[r]=v,s}(function(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++){var s=t[i];"function"==typeof e[s]&&(n[s]=e[s])}var r,o=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:l.INIT}))throw new Error(a(12));if(void 0===n(void 0,{type:l.PROBE_UNKNOWN_ACTION()}))throw new Error(a(13))}))}(n)}catch(e){r=e}return function(e,t){if(void 0===e&&(e={}),r)throw r;for(var i=!1,s={},l=0;l<o.length;l++){var d=o[l],c=n[d],h=e[d],m=c(h,t);if(void 0===m)throw t&&t.type,new Error(a(14));s[d]=m,i=i||m!==h}return(i=i||o.length!==Object.keys(e).length)?s:e}}({page:(e=h,t)=>{switch(t.type){case c:return Object.assign(Object.assign({},e),{category:t.text});default:return e}},mode:(e=u,t)=>{switch(t.type){case m:return Object.assign(Object.assign({},e),{isPlayMode:!e.isPlayMode});default:return e}}})),g=e=>e.replace(/\s/g,"-").toLocaleLowerCase();class w extends e{constructor(t){super(t,"div",["popup-overlay"]),this.loginBtnClickHandler=()=>{"admin"===this.loginField.element.value&&"admin"===this.passwordField.element.value&&(window.location.hash="/admin")},this.popup=new e(this.element,"div",["popup"]),this.header=new e(this.popup.element,"div",["popup__header"]),this.title=new e(this.header.element,"p",["popup__title"],"Login"),this.groupWrapper=new e(this.header.element,"div",["popup__group-wrapper"]),this.loginWrapper=new e(this.groupWrapper.element,"div",["popup__field-group"]),this.loginLabel=new e(this.loginWrapper.element,"label",["popup__label"],"login"),this.loginField=new e(this.loginWrapper.element,"input",["popup__field"]),this.passwordWrapper=new e(this.groupWrapper.element,"div",["popup__field-group"]),this.passwordLabel=new e(this.passwordWrapper.element,"label",["popup__label"],"password"),this.passwordField=new e(this.passwordWrapper.element,"input",["popup__field"]),this.footer=new e(this.popup.element,"div",["popup__footer"]),this.cancelBtn=new e(this.footer.element,"button",["popup__btn","popup__cancel-btn"],"Cancel"),this.loginBtn=new e(this.footer.element,"button",["popup__btn","popup__login-btn"],"Login"),this.cancelBtn.element.addEventListener("click",(()=>this.closePopup())),this.loginBtn.element.addEventListener("click",this.loginBtnClickHandler)}showPopup(){this.element.classList.add("popup-overlay--active")}closePopup(){this.element.classList.remove("popup-overlay--active")}}class f extends e{constructor(t,n){super(t,"nav",["main-nav"]),this.routes=n,this.toggleClickHandler=e=>{e.stopPropagation(),this.transformLines(),this.toggleMenu()},this.menuOutsideClickHandler=e=>{e.target.closest(".popup-overlay")||e.target.closest(".main-nav__menu")||(this.transformLines(),this.toggleMenu())},this.loginBtnClickHandler=()=>{this.popup.showPopup()},this.menuItemClickHandler=e=>{this.transformLines(),this.toggleMenu(),p.dispatch({type:"UPDATE_PAGE",text:e.target.categoryId})},this.toggle=new e(this.element,"button",["main-nav__toggle"],"",[["type","button"]]),this.lines=new e(this.toggle.element,"span",["main-nav__lines"]),this.menuContainer=new e(this.element,"div",["main-nav__menu"]),this.menu=new e(this.menuContainer.element,"ul",["main-nav__list"]),this.menuItems=[],this.addMenuItems(),this.loginBtn=new e(this.menuContainer.element,"button",["main-nav__login-btn"],"Login"),this.popup=new w(this.element),this.setEventHandlers(),this.highlightMenuItem()}setEventHandlers(){this.toggle.element.addEventListener("click",this.toggleClickHandler),this.loginBtn.element.addEventListener("click",this.loginBtnClickHandler)}transformLines(){this.toggle.element.classList.toggle("main-nav__toggle--open")}toggleMenu(){this.menuContainer.element.classList.toggle("main-nav__menu--open"),this.menuContainer.element.classList.contains("main-nav__menu--open")?document.addEventListener("click",this.menuOutsideClickHandler):document.removeEventListener("click",this.menuOutsideClickHandler)}createMenuItem(t,n,i){const s=new e(this.menu.element,"li",["main-nav__item"]),a=new e(s.element,"a",["main-nav__link"],`${t}`,[["href",`#/${n}`]]);return i&&(a.element.categoryId=i),this.menuItems.push(s.element),a.element.addEventListener("click",this.menuItemClickHandler),a}highlightMenuItem(){var e;const t=window.location.hash.slice(2);this.activeMenuItem=""===t?this.menuItems.find((e=>"Main Page"===e.textContent)):this.menuItems.find((e=>g(e.textContent)===t)),null===(e=this.activeMenuItem)||void 0===e||e.classList.add("main-nav__item--active")}addMenuItems(){this.routes.forEach((e=>{e.menu&&this.createMenuItem(e.name,e.path,e.categoryId)}))}}class _ extends e{constructor(t){super(t,"div",["switch"]),this.changePlayMode=()=>{p.dispatch({type:m})},this.field=new e(this.element,"input",["switch__field"],"",[["id","switch-label"],["type","checkbox"]]),this.label=new e(this.element,"label",["switch__label"],"",[["for","switch-label"]]),this.text=new e(this.label.element,"span",["switch__text"]),this.slider=new e(this.label.element,"span",["switch__slider"]),this.field.element.addEventListener("change",this.changePlayMode),this.setGameMode()}setGameMode(){const{isPlayMode:e}=p.getState().mode;e&&(this.field.element.checked=!0)}}class v extends e{constructor(t,n){super(t,"header",["container","header"]),this.wrapper=new e(this.element,"div",["header__wrapper"]),this.nav=new f(this.wrapper.element,n),this.switch=new _(this.wrapper.element)}}const y="https://fringuante-bastille-07764.herokuapp.com",b=async()=>{const e=await fetch(`${y}/api/categories`);return await e.json()},C=async()=>{const e=await fetch(`${y}/api/words`);return await e.json()};class E extends e{constructor(t,n,i){super(t,"div",["admin__card"]),this.categoryData=n,this.deleteBtnClickHandler=async()=>{await(async e=>{const t=await fetch(`${y}/api/categories/${e}`,{method:"DELETE"});return await t.json()})(this.categoryId),this.deleteCategoryCard()},this.updateBtnClickHandler=()=>{this.toggleElement(this.cardInfo.element),this.toggleElement(this.cardUpdate.element),this.categoryData.category=this.field.element.value},this.cancelBtnClickHandler=()=>{this.toggleElement(this.cardInfo.element),this.toggleElement(this.cardUpdate.element),this.field.element.value=this.categoryData.category},this.createBtnClickHandler=async()=>{this.toggleElement(this.cardInfo.element),this.toggleElement(this.cardUpdate.element),this.updateTitleText(),await(async(e,t)=>{const n=await fetch(`${y}/api/categories/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await n.json()})(this.categoryData.id,{category:this.field.element.value})},this.toggleElement=e=>{e.classList.toggle("hidden")},this.cardInfo=new e(this.element,"div",["admin__card-info"]),this.title=new e(this.cardInfo.element,"h2",["admin__card-title"],n.category),this.body=new e(this.cardInfo.element,"p",["admin__card-body"],"Words: "),this.wordsCount=new e(this.body.element,"span",["admin__card-count"],`${i}`),this.footer=new e(this.cardInfo.element,"div",["admin__card-footer"]),this.updateBtn=new e(this.footer.element,"button",["admin__btn","admin__update-btn"],"Update"),this.addBtn=new e(this.footer.element,"button",["admin__btn","admin__add-btn"],"Add word"),this.deleteBtn=new e(this.element,"button",["admin__delete-btn"]),this.cardUpdate=new e(this.element,"div",["admin__card-update","hidden"]),this.updateGroup=new e(this.cardUpdate.element,"div",["admin__field-group"]),this.label=new e(this.updateGroup.element,"label",["admin__label"],"Category Name:"),this.field=new e(this.updateGroup.element,"input",["admin__field"],"",[["value",`${n.category}`]]),this.footerUpdate=new e(this.cardUpdate.element,"div",["admin__card-footer"]),this.cancelBtn=new e(this.footerUpdate.element,"button",["admin__btn","admin__cancel-btn"],"Cancel"),this.createBtn=new e(this.footerUpdate.element,"button",["admin__btn","admin__create-btn"],"Create"),this.categoryId=n.id,this.deleteBtn.element.addEventListener("click",this.deleteBtnClickHandler),this.updateBtn.element.addEventListener("click",this.updateBtnClickHandler),this.cancelBtn.element.addEventListener("click",this.cancelBtnClickHandler),this.createBtn.element.addEventListener("click",this.createBtnClickHandler)}deleteCategoryCard(){this.element.remove()}updateTitleText(){this.title.element.textContent=`${this.field.element.value}`}}const k=[{name:"Categories",path:"admin"},{name:"Words",path:"words"}];class L extends e{constructor(t){super(null,"div",["main"]),this.createCat=async()=>{var e;const t=await(async e=>{const t=await fetch(`${y}/api/categories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:"New category",image:"images/default.png"})});return await t.json()})(),n=new E(null,t,0);n.toggleElement(n.cardInfo.element),n.toggleElement(n.cardUpdate.element),null===(e=this.addCategoryCard)||void 0===e||e.element.before(n.element)},this.logoutBtnClickHandler=()=>{window.location.hash="#/"},this.header=new e(t,"header",["header","admin__header"]),this.wrapper=new e(this.header.element,"div",["container","admin__header-wrapper"]),this.main=new e(t,"main",["container","admin__main"]),this.container=new e(this.main.element,"div",["admin__cards-field"]),this.menu=new e(this.wrapper.element,"ul",["admin__nav-list"]),this.logoutBtn=new e(this.wrapper.element,"button",["admin__btn-logout"],"Log out"),this.menuItems=[],this.addMenuItems(),this.logoutBtn.element.addEventListener("click",this.logoutBtnClickHandler),this.addCategoryCards()}addMenuItems(){k.forEach((e=>this.createMenuItem(e.name,e.path)))}createMenuItem(t,n){const i=new e(this.menu.element,"li",["admin__nav-item"]),s=new e(i.element,"a",["admin__nav-link"],`${t}`,[["href",`#/${n}`]]);return this.menuItems.push(i.element),s}createAddCategoryCard(){this.addCategoryCard=new e(this.container.element,"div",["admin__card"]),(()=>{new e(this.addCategoryCard.element,"h2",["admin__card-title"],"Create new Category")})(),this.addCategoryBtn=new e(this.addCategoryCard.element,"button",["admin__add-category-btn"]),this.addCategoryBtn.element.addEventListener("click",this.createCat)}async addCategoryCards(){const e=await b(),t=await C();e.forEach((async e=>{const n=t.filter((t=>t.categoryId===e.id)).length;(()=>{new E(this.container.element,e,n)})()})),this.createAddCategoryCard()}}class H extends e{constructor(t,n){super(t,"a",["category-card"],"",[["href",`#/${g(n.category)}`]]),this.categoryData=n,this.cardClickHandler=()=>{var e;p.dispatch((e=this.categoryData.id,{type:c,text:e}))},this.image=new e(this.element,"img",["category-card__img"],"",[["src",`./${n.image}`],["alt",n.category]]),this.title=new e(this.element,"h3",["category-card__title"],n.category),this.setEventHandlers()}setEventHandlers(){this.element.addEventListener("click",this.cardClickHandler)}}class I extends e{constructor(t){super(t,"main",["container","main"]),this.container=new e(this.element,"div",["cards__field"]),this.addCategoryCards()}async addCategoryCards(){(await b()).forEach((e=>new H(this.container.element,e)))}}class B extends e{constructor(t,n,i){super(t,"div",["card-container"]),this.toggleCardMode=()=>{const{isPlayMode:e}=p.getState().mode;e?this.cardFront.element.removeEventListener("click",this.cardClickHandler):this.cardFront.element.addEventListener("click",this.cardClickHandler)},this.flipperClickHandler=e=>{e.stopPropagation(),this.flipToFront()},this.cardClickHandler=()=>{this.playAudio();const e=localStorage.getItem("statistics"),t=JSON.parse(e);t.find((e=>e.id===this.wordId)).click++,localStorage.setItem("statistics",JSON.stringify(t))},this.flipToFront=()=>{this.flip(),this.card.element.addEventListener("mouseleave",this.flipToBack,{once:!0})},this.flipToBack=()=>{this.flip()},this.playAudio=()=>{this.audio.play()},this.card=new e(this.element,"div",["card"]),this.wordId=n.id,this.category=i,this.cardFront=new e(this.card.element,"div",["card__front"]),this.cardFrontHeader=new e(this.cardFront.element,"div",["card__header"],"",[["style",`background-image: url(./${n.image})`]]),this.cardFrontFooter=new e(this.cardFront.element,"p",["card__footer","card__footer--front"],n.word),this.flipper=new e(this.cardFrontFooter.element,"div",["card__flipper"]),this.cardBack=new e(this.card.element,"div",["card__back"]),this.cardBackHeader=new e(this.cardBack.element,"div",["card__header"],"",[["style",`background-image: url(./${n.image})`]]),this.cardBackFooter=new e(this.cardBack.element,"p",["card__footer"],n.translation),this.audio=new Audio(`./${n.audioSrc}`),this.toggleCardMode(),this.unsubscribe=p.subscribe(this.toggleCardMode),this.setEventHandlers()}setEventHandlers(){this.flipper.element.addEventListener("click",this.flipperClickHandler),window.addEventListener("hashchange",(()=>this.unsubscribe()),{once:!0})}flip(){this.card.element.classList.toggle("card--flipped")}}class P extends e{constructor(t,n){super(t,"section",[`${n}`,"cards"]),this.container=new e(this.element,"div",["cards__field"])}}class M extends e{constructor(t){super(t,"main",["container","main","main--category"]),this.repeatAudio=()=>{var e;null===(e=this.currentCard)||void 0===e||e.playAudio()},this.startGame=()=>{var e,t;this.shuffleCards=(e=>{let t,n;const i=[...e];for(let s=e.length-1;s>0;s--)t=Math.floor(Math.random()*(s+1)),n=i[t],i[t]=i[s],i[s]=n;return i})(this.cards),this.currentCard=this.shuffleCards.pop(),this.category=null===(e=this.currentCard)||void 0===e?void 0:e.category,null===(t=this.currentCard)||void 0===t||t.playAudio(),this.button.element.classList.add("category__btn--repeat"),this.button.element.addEventListener("click",this.repeatAudio),this.cardsField.container.element.addEventListener("click",this.cardFieldClickHandler)},this.finishGame=()=>{this.cardsField.element.remove(),this.errors?(this.result=new e(this.element,"div",["category__result","category__result--failure"]),this.loseAudio.play()):(this.result=new e(this.element,"div",["category__result"]),this.winAudio.play()),setTimeout((()=>{window.location.hash="#/"}),3e3)},this.cardFieldClickHandler=t=>{var n,i,s,a;const r=t.target.closest(".card");if(!r)return;(null===(n=this.shuffleCards)||void 0===n?void 0:n.length)||this.finishGame();const o=localStorage.getItem("statistics"),l=JSON.parse(o),d=l.find((e=>{var t;return e.id===(null===(t=this.currentCard)||void 0===t?void 0:t.wordId)}));r===(null===(i=this.currentCard)||void 0===i?void 0:i.card.element)?(this.correctAudio.play(),r.classList.add("card--inactive"),(()=>{new e(this.stars.element,"div",["category__star"])})(),d.hit++,this.currentCard=null===(s=this.shuffleCards)||void 0===s?void 0:s.pop(),this.category=null===(a=this.currentCard)||void 0===a?void 0:a.category,setTimeout((()=>{var e;return null===(e=this.currentCard)||void 0===e?void 0:e.playAudio()}),1e3)):((()=>{new e(this.stars.element,"div",["category__star","category__star--error"])})(),this.errorAudio.play(),this.errors++,d.miss++),d.percent=this.getHitsPercent(d),localStorage.setItem("statistics",JSON.stringify(l))},this.controlButtonState=()=>{const{isPlayMode:e}=p.getState().mode;this.button.element.removeEventListener("click",this.repeatAudio),this.cardsField.container.element.removeEventListener("click",this.cardFieldClickHandler),this.stars.element.innerHTML="",this.errors=0,this.cards.forEach((e=>{e.card.element.classList.remove("card--inactive")})),e&&(this.button.element.classList.remove("category__btn--repeat"),this.button.element.addEventListener("click",this.startGame,{once:!0}))},this.getHitsPercent=e=>e.hit/(e.hit+e.miss)?Math.round(e.hit/(e.hit+e.miss)*100):e.percent,this.cardsField=new P(this.element,"category"),this.stars=new e(null,"div",["category__stars"]),this.cardsField.element.prepend(this.stars.element),this.button=new e(this.cardsField.element,"button",["category__btn--start"],"Start"),this.category=p.getState().page.category,this.cards=[],this.errors=0,this.errorAudio=new Audio("./audio/error.mp3"),this.correctAudio=new Audio("./audio/correct.mp3"),this.winAudio=new Audio("./audio/success.mp3"),this.loseAudio=new Audio("./audio/failure.mp3"),this.addCategoryCards(),this.unsubscribe=p.subscribe(this.controlButtonState),this.setEventHandlers()}setEventHandlers(){this.button.element.addEventListener("click",this.startGame,{once:!0}),window.addEventListener("hashchange",(()=>this.unsubscribe()),{once:!0})}async addCategoryCards(){(await(async e=>{const t=await fetch(`${y}/api/words`);return(await t.json()).filter((t=>t.categoryId===e))})(this.category)).forEach((e=>{const t=new B(this.cardsField.container.element,e,this.category);this.cards.push(t)}))}}const x=async()=>{if(!localStorage.getItem("statistics")){const e=[],t=await C(),n=await b();t.forEach((t=>{var i;e.push({category:null===(i=n.find((e=>e.id===t.categoryId)))||void 0===i?void 0:i.category,word:t.word,translation:t.translation,click:0,hit:0,miss:0,percent:0,id:t.id})})),localStorage.setItem("statistics",JSON.stringify(e))}};class A extends e{constructor(t){var n;super(t,"main",["container","main"]),this.transformCellContent=e=>Number.isNaN(Number(e))?e:Number(e),this.controlSortTriangle=(e,t)=>{"asc"===e?(t.classList.add("sorted"),t.classList.remove("sorted-reverse")):(t.classList.add("sorted-reverse"),t.classList.remove("sorted"))},this.resetBtnClickHandler=async()=>{localStorage.clear(),await x(),this.clearTable(),this.addWords()},this.repeatBtnClickHandler=()=>{window.location.hash="#/difficult-words"},this.clearTable=()=>{this.tableBody.element.innerHTML=""},this.buttonsContainer=new e(this.element,"div",["statistics__btn-container"]),this.repeatBtn=new e(this.buttonsContainer.element,"button",["statistics__btn","statistics__btn--repeat"],"Repeat difficult words"),this.resetBtn=new e(this.buttonsContainer.element,"button",["statistics__btn","statistics__btn--reset"],"Reset"),this.container=new e(this.element,"div",["statistics__table-container"]),this.table=new e(this.container.element,"table",["statistics__table"]),this.tableHead=new e(this.table.element,"thead"),this.categoryTh=new e(this.tableHead.element,"th",[],"Category"),this.wordTh=new e(this.tableHead.element,"th",[],"Word"),this.translationTh=new e(this.tableHead.element,"th",[],"Translation"),this.tableBody=new e(this.table.element,"tbody"),this.clickTh=new e(this.tableHead.element,"th",[],"Clicks"),this.hitTh=new e(this.tableHead.element,"th",[],"Hits"),this.missTh=new e(this.tableHead.element,"th",[],"Misses"),this.percentTh=new e(this.tableHead.element,"th",[],"%"),this.tableHeaders=[...null===(n=this.table.element.tHead)||void 0===n?void 0:n.children],this.repeatBtn.element.addEventListener("click",this.repeatBtnClickHandler),this.resetBtn.element.addEventListener("click",this.resetBtnClickHandler),this.tableHeaders.forEach(((e,t)=>e.addEventListener("click",(()=>this.sortRows(t,e))))),this.sortDirections=this.tableHeaders.map((()=>"")),this.addWords()}addWords(){const t=localStorage.getItem("statistics");t&&JSON.parse(t).forEach((t=>{const n=new e(this.tableBody.element,"tr");new e(n.element,"td",[],t.category),new e(n.element,"td",[],t.word),new e(n.element,"td",[],t.translation),new e(n.element,"td",[],`${t.click}`),new e(n.element,"td",[],`${t.hit}`),new e(n.element,"td",[],`${t.miss}`),new e(n.element,"td",[],`${t.percent}`)}))}sortRows(e,t){const n=[...this.table.element.rows],i=this.sortDirections[e]||"asc",s="asc"===i?1:-1;this.controlSortTriangle(i,t),n.sort(((t,n)=>{const i=t.cells[e].textContent,a=n.cells[e].textContent,r=this.transformCellContent(i),o=this.transformCellContent(a);return r>o?1*s:r<o?-1*s:0})),this.sortDirections[e]="asc"===i?"desc":"asc",this.table.element.tBodies[0].append(...n)}}class T extends M{async addCategoryCards(){const e=localStorage.getItem("statistics"),t=JSON.parse(e).filter((e=>e.miss)).sort(((e,t)=>e.percent-t.percent)).slice(0,8);t.length?t.forEach((async e=>{const t=await(async e=>{const t=await fetch(`${y}/api/words/${e}`);return await t.json()})(e.id),n=new B(this.cardsField.container.element,t,e.category);this.cards.push(n)})):this.cardsField.element.remove()}}async function S(){return(await b()).map((e=>({name:e.category,path:g(e.category),Page:M,menu:!0,categoryId:e.id})))}class O{constructor(e){this.rootElement=e,this.routes=[],this.render(),this.hashChangeHandler()}async render(){this.routes=await async function(){return[{name:"Main Page",path:"",Page:I,menu:!0},...await S(),{name:"Statistics",path:"statistics",Page:A,menu:!0},{name:"Repeat",path:"difficult-words",Page:T,menu:!1},{name:"Admin",path:"admin",Page:L,menu:!1}]}(),this.parseLocation();const{Page:e}=this.findPage();document.body.innerHTML="",e===L?new e(document.body):((()=>{new v(this.rootElement,this.routes)})(),(()=>{new e(this.rootElement)})(),(()=>{new s(this.rootElement)})())}parseLocation(){this.location=window.location.hash.slice(2)}findPage(){return this.routes.find((e=>e.path===this.location))}hashChangeHandler(){window.addEventListener("hashchange",(()=>this.render()))}}const N=document.body;window.location.hash="#/",new class{constructor(e){this.rootElement=e,this.page=new O(e),p.subscribe((()=>{const{isPlayMode:e}=p.getState().mode;this.rootElement.dataset.mode=e?"play":"train"})),x()}}(N)})()})();